<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Plotting geological/stratigraphical patterns • deeptime</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Plotting geological/stratigraphical patterns">
<meta name="robots" content="noindex">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-B48C68KGQJ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B48C68KGQJ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">deeptime</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">2.1.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/coord_geo.html">Adding geological timescales to plots</a></li>
    <li><a class="dropdown-item" href="../articles/phylogenies.html">Adding geological timescales to phylogenies</a></li>
    <li><a class="dropdown-item" href="../articles/coord.html">Transforming coordinate systems</a></li>
    <li><a class="dropdown-item" href="../articles/traits.html">Plotting trait data</a></li>
    <li><a class="dropdown-item" href="../articles/time.html">Plotting temporal data</a></li>
    <li><a class="dropdown-item" href="../articles/geo.html">Plotting geological/stratigraphical patterns</a></li>
    <li><a class="dropdown-item" href="../articles/ggarrange2.html">Combining and arranging plots</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/willgearty/deeptime/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plotting geological/stratigraphical patterns</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/willgearty/deeptime/blob/master/vignettes/geo.Rmd" class="external-link"><code>vignettes/geo.Rmd</code></a></small>
      <div class="d-none name"><code>geo.Rmd</code></div>
    </div>

    
    
<div style="text-align: justify">
<p>In 2006, the <a href="https://www.usgs.gov/" class="external-link">U.S. Geological
Survey</a> and the <a href="https://ngmdb.usgs.gov/fgdc_gds/index.php" class="external-link">Geologic Data
Subcommittee</a> of the <a href="https://www.fgdc.gov/" class="external-link">Federal
Geographic Data Committee</a> established the <a href="https://ngmdb.usgs.gov/fgdc_gds/geolsymstd.php" class="external-link">Digital
Cartographic Standard for Geologic Map Symbolization</a>. This is the
National Standard for the digital cartographic representation of
geologic map features, including line symbols, point symbols, colors,
and patterns. The standard patterns that are put forth in this document
are included in <strong>deeptime</strong> (<a href="https://github.com/davenquinn/geologic-patterns/" class="external-link">thanks to the
work that Daven Quinn put in to extracting them as SVGs</a>). Let’s
explore the functionality that <strong>deeptime</strong> has to retrieve
and utilize these patterns.</p>
<p>Let’s first load the packages we’ll need:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load deeptime</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://williamgearty.com/deeptime/">deeptime</a></span><span class="op">)</span></span>
<span><span class="co">## Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">##   object 'type_sum.accel' not found</span></span>
<span><span class="co"># Load rmacrostrat to get data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rmacrostrat.palaeoverse.org" class="external-link">rmacrostrat</a></span><span class="op">)</span></span>
<span><span class="co"># Load packages for data visualization</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/" class="external-link">ggrepel</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="stratigraphic-columns">Stratigraphic columns<a class="anchor" aria-label="anchor" href="#stratigraphic-columns"></a>
</h2>
<p>The <a href="https://rmacrostrat.palaeoverse.org/" class="external-link"><strong>rmacrostrat</strong></a>
package allows users to access the Macrostrat API, which includes
various geological data (e.g., lithostratigraphic units) and
definitions/metadata associated with those data. The package includes a
number of <a href="https://rmacrostrat.palaeoverse.org/articles/" class="external-link">vignettes</a> that
walk through how to retrieve and visualize various types of data from
the database. Here, we’re going to be plotting a stratigraphic column
for the San Juan Basin, a large structural depression which spans parts
of New Mexico, Colorado, Utah, and Arizona. The details about
downloading this data are thoroughly presented in <a href="https://rmacrostrat.palaeoverse.org/articles/stratigraphic-column.html" class="external-link">this
<strong>rmacrostrat</strong> vignette</a>. For the purposes of this
<strong>deeptime</strong> vignette, we’ll skip ahead and download the
unit-level stratigraphic data for this basin during the Cretaceous:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the column ID, retrieve the units in the San Juan Basin column</span></span>
<span><span class="va">san_juan_units</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rmacrostrat.palaeoverse.org/reference/get_units.html" class="external-link">get_units</a></span><span class="op">(</span>column_id <span class="op">=</span> <span class="fl">489</span>, interval_name <span class="op">=</span> <span class="st">"Cretaceous"</span><span class="op">)</span></span>
<span><span class="co"># See the column names and number of rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">san_juan_units</span><span class="op">)</span></span>
<span><span class="co">##  [1] "unit_id"          "section_id"       "col_id"           "project_id"      </span></span>
<span><span class="co">##  [5] "col_area"         "unit_name"        "strat_name_id"    "Mbr"             </span></span>
<span><span class="co">##  [9] "Fm"               "Gp"               "SGp"              "t_age"           </span></span>
<span><span class="co">## [13] "b_age"            "max_thick"        "min_thick"        "outcrop"         </span></span>
<span><span class="co">## [17] "pbdb_collections" "pbdb_occurrences" "lith"             "environ"         </span></span>
<span><span class="co">## [21] "econ"             "measure"          "notes"            "color"           </span></span>
<span><span class="co">## [25] "text_color"       "t_int_id"         "t_int_name"       "t_int_age"       </span></span>
<span><span class="co">## [29] "t_prop"           "units_above"      "b_int_id"         "b_int_name"      </span></span>
<span><span class="co">## [33] "b_int_age"        "b_prop"           "units_below"      "strat_name_long" </span></span>
<span><span class="co">## [37] "refs"             "clat"             "clng"             "t_plat"          </span></span>
<span><span class="co">## [41] "t_plng"           "b_plat"           "b_plng"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">san_juan_units</span><span class="op">)</span></span>
<span><span class="co">## [1] 17</span></span></code></pre></div>
<div class="section level3">
<h3 id="plot-stratigraphic-column">Plot stratigraphic column<a class="anchor" aria-label="anchor" href="#plot-stratigraphic-column"></a>
</h3>
<p>We now have information for each of the 17 Cretaceous geologic units
contained within the San Juan Basin, including the age of the top and
bottom of each, which is what we will use to plot our stratigraphic
column. We’ll follow the <strong>rmacrostrat</strong> vignette to plot
the stratigraphic column:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify x_min and x_max in dataframe</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">x_min</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">x_max</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co"># Tweak values for overlapping units</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">x_max</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">x_min</span><span class="op">[</span><span class="fl">11</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="co"># Add midpoint age for plotting</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">m_age</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">b_age</span> <span class="op">+</span> <span class="va">san_juan_units</span><span class="op">$</span><span class="va">t_age</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_juan_units</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">b_age</span>, ymax <span class="op">=</span> <span class="va">t_age</span>,</span>
<span>                           xmin <span class="op">=</span> <span class="va">x_min</span>, xmax <span class="op">=</span> <span class="va">x_max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot units, colored by rock type</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">san_juan_units</span><span class="op">$</span><span class="va">color</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add text labels</span></span>
<span>  <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_max</span>, y <span class="op">=</span> <span class="va">m_age</span>, label <span class="op">=</span> <span class="va">unit_name</span><span class="op">)</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">3.5</span>, hjust <span class="op">=</span> <span class="fl">0</span>, force <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  min.segment.length <span class="op">=</span> <span class="fl">0</span>, direction <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                  nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep_len</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">17</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reverse direction of y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">66</span><span class="op">)</span>, n.breaks <span class="op">=</span> <span class="fl">10</span>, name <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theming</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add geological time scale</span></span>
<span>  <span class="fu"><a href="../reference/coord_geo.html">coord_geo</a></span><span class="op">(</span>pos <span class="op">=</span> <span class="st">"left"</span>, dat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"stages"</span><span class="op">)</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
<p><img src="geo_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="use-stratigraphic-patterns">Use stratigraphic patterns<a class="anchor" aria-label="anchor" href="#use-stratigraphic-patterns"></a>
</h3>
<p>Isn’t that snazzy! You’ll see that we used the colors that come
straight from Macrostrat (i.e., the “color” column) to visualize the
different units. Presumably these colors represent something about the
different lithologies of the units. However, we could also represent
these lithologies with our standardized FGDC patterns. First, we’ll need
to get the lithology definitions from Macrostrat, which includes the
FGDC pattern codes:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get lithology definitions</span></span>
<span><span class="va">liths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rmacrostrat.palaeoverse.org/reference/def_lithologies.html" class="external-link">def_lithologies</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">liths</span><span class="op">)</span></span>
<span><span class="co">##   lith_id          name          type          group       class   color fill</span></span>
<span><span class="co">## 1       1 siliciclastic siliciclastic                sedimentary #FFF400  670</span></span>
<span><span class="co">## 2       2        gravel siliciclastic unconsolidated sedimentary #FFAB00  601</span></span>
<span><span class="co">## 3       3          sand siliciclastic unconsolidated sedimentary #FFCA00  607</span></span>
<span><span class="co">## 4       4          silt siliciclastic unconsolidated sedimentary #919AA3  619</span></span>
<span><span class="co">## 5       5           mud siliciclastic unconsolidated sedimentary #A7ACB0  641</span></span>
<span><span class="co">## 6       6     claystone siliciclastic       mudrocks sedimentary #B2B5B7  620</span></span>
<span><span class="co">##   t_units</span></span>
<span><span class="co">## 1     346</span></span>
<span><span class="co">## 2    1215</span></span>
<span><span class="co">## 3   12349</span></span>
<span><span class="co">## 4    9356</span></span>
<span><span class="co">## 5    8442</span></span>
<span><span class="co">## 6    5101</span></span></code></pre></div>
<p>In this output, the “fill” column corresponds to the FGDC pattern
code for each lithology. Now, we need to figure out the lithology of
each of our San Juan units. However, you’ll notice that some units have
multiple lithologies:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Count lithologies for each unit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">lith</span>, <span class="va">nrow</span><span class="op">)</span></span>
<span><span class="co">##  [1] 1 1 1 2 1 1 1 3 3 1 1 1 1 1 1 6 3</span></span>
<span><span class="co"># Inspect one with multiple rows</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">lith</span><span class="op">[</span><span class="fl">16</span><span class="op">]</span></span>
<span><span class="co">## [[1]]</span></span>
<span><span class="co">##         atts      name   prop lith_id            type       class</span></span>
<span><span class="co">## 1                shale 0.0714       8   siliciclastic sedimentary</span></span>
<span><span class="co">## 2            quartzite 0.3571      85 metasedimentary metamorphic</span></span>
<span><span class="co">## 3            sandstone 0.3571      10   siliciclastic sedimentary</span></span>
<span><span class="co">## 4        red claystone 0.0714       6   siliciclastic sedimentary</span></span>
<span><span class="co">## 5 calcareous      clay 0.0714      93   siliciclastic sedimentary</span></span>
<span><span class="co">## 6 calcareous      clay 0.0714      93   siliciclastic sedimentary</span></span></code></pre></div>
<p>That’s a lot of different lithologies for this single unit! We could
theoretically represent all of the lithologies, but let’s just go ahead
and extract the primary lithology, or the one with the highest “prop”
value (i.e., proportion of unit):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the primary lithology for each unit</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">lith_prim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">lith</span>, <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">name</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">prop</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">lith_prim</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## conglomerate    graywacke  litharenite    quartzite    sandstone        shale </span></span>
<span><span class="co">##            1            1            1            1            6            7</span></span></code></pre></div>
<p>Now that we’ve assigned a primary lithology to each unit, we can
assign an FGDC pattern code to each unit:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign pattern code</span></span>
<span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">pattern</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">liths</span><span class="op">$</span><span class="va">fill</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">lith_prim</span>, <span class="va">liths</span><span class="op">$</span><span class="va">name</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">san_juan_units</span><span class="op">$</span><span class="va">pattern</span>, exclude <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## 602 607 620 654 702 </span></span>
<span><span class="co">##   1   6   7   2   1</span></span></code></pre></div>
<p>Excellent, we now have a pattern code for each unit! Now we can go
ahead and use these instead of the colors for the fills of the units. In
order to convert the codes to visual patterns, we’ll need to move the
<code>fill</code> argument to a call to <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> and we’ll
need to add a call to <code><a href="../reference/scale_fill_geopattern.html">scale_fill_geopattern()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot with pattern fills</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_juan_units</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">b_age</span>, ymax <span class="op">=</span> <span class="va">t_age</span>,</span>
<span>                           xmin <span class="op">=</span> <span class="va">x_min</span>, xmax <span class="op">=</span> <span class="va">x_max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot units, patterned by rock type</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">pattern</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/scale_fill_geopattern.html">scale_fill_geopattern</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add text labels</span></span>
<span>  <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_max</span>, y <span class="op">=</span> <span class="va">m_age</span>, label <span class="op">=</span> <span class="va">unit_name</span><span class="op">)</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">3.5</span>, hjust <span class="op">=</span> <span class="fl">0</span>, force <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  min.segment.length <span class="op">=</span> <span class="fl">0</span>, direction <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                  nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep_len</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">17</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reverse direction of y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">66</span><span class="op">)</span>, n.breaks <span class="op">=</span> <span class="fl">10</span>, name <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theming</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add geological time scale</span></span>
<span>  <span class="fu"><a href="../reference/coord_geo.html">coord_geo</a></span><span class="op">(</span>pos <span class="op">=</span> <span class="st">"left"</span>, dat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"stages"</span><span class="op">)</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
<p><img src="geo_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="further-customization">Further customization<a class="anchor" aria-label="anchor" href="#further-customization"></a>
</h3>
<p>If you use <code><a href="../reference/scale_fill_geopattern.html">scale_fill_geopattern()</a></code>, the patterns are
used with the default parameters (e.g., line color, background color,
and scale). However, if you’d like to customize how the patterns look,
you can use the <code>geom_</code> functions from the <a href="https://trevorldavis.com/R/ggpattern/" class="external-link"><strong>ggpattern</strong></a>
package (e.g., <code><a href="https://trevorldavis.com/R/ggpattern/reference/geom-docs.html" class="external-link">geom_rect_pattern()</a></code>) and use the “geo”
<code>pattern</code>. Once you have implemented this, any of the
following ggplot2 aesthetics can be used to tweak the patterns. <em>Note
that the defaults for these two methods are often different:</em></p>
<table class="table">
<colgroup>
<col width="20%">
<col width="37%">
<col width="8%">
<col width="32%">
</colgroup>
<thead><tr class="header">
<th>aesthetic</th>
<th>description</th>
<th>
<code><a href="../reference/scale_fill_geopattern.html">scale_fill_geopattern()</a></code> default</th>
<th>ggpattern default</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>pattern_type</td>
<td>Code for the FGDC pattern to use</td>
<td>“101”</td>
<td>“101”</td>
</tr>
<tr class="even">
<td>pattern_color</td>
<td>Color used for strokes and points</td>
<td>original color</td>
<td>“grey20”</td>
</tr>
<tr class="odd">
<td>pattern_fill</td>
<td>Color used to fill various closed shapes (e.g., circles) in the
pattern</td>
<td>original color</td>
<td>“grey80”</td>
</tr>
<tr class="even">
<td>pattern_alpha</td>
<td>Alpha transparency for pattern</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>pattern_scale</td>
<td>Scale of the pattern (higher values zoom in on pattern)</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="even">
<td>fill</td>
<td>Background color</td>
<td>“white”</td>
<td>“white”</td>
</tr>
</tbody>
</table>
<p>For the pattern code (i.e., <code>pattern\_type</code>), see the
“pattern numbers” in the <a href="https://ngmdb.usgs.gov/fgdc_gds/geolsymstd/fgdc-geolsym-patternchart.pdf" class="external-link">full
pattern chart</a> for the full list of options. Daven Quinn has also
assembled more accessible documentation of the <a href="https://davenquinn.com/projects/geologic-patterns/#pattern-reference" class="external-link">map
patterns/codes</a> and <a href="https://davenquinn.com/projects/geologic-patterns/#series-600" class="external-link">lithology
patterns/codes</a>. <code><a href="https://rmacrostrat.palaeoverse.org/reference/def_lithologies.html" class="external-link">def_lithologies()</a></code> can also be used to
look up pattern codes for various lithologies (see the “fill” column).
Note that codes associated with color variants (e.g., “101-M”) are
supported but will result in the default color variant instead (usually
black and white). Most, if not all, color variants can be recreated by
adjusting the color, fill, and background of the pattern.</p>
<p>Let’s try increasing the scale of the patterns in our stratigraphic
column. We’ll need to switch to using <code><a href="https://trevorldavis.com/R/ggpattern/reference/geom-docs.html" class="external-link">geom_rect_pattern()</a></code>.
Since we are specifying the patterns within an <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> call,
we can use <code><a href="https://trevorldavis.com/R/ggpattern/reference/scale_pattern_identity.html" class="external-link">scale_pattern_type_identity()</a></code> to use those raw
pattern codes:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot using ggpattern</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trevorld/ggpattern" class="external-link">ggpattern</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_juan_units</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">b_age</span>, ymax <span class="op">=</span> <span class="va">t_age</span>,</span>
<span>                           xmin <span class="op">=</span> <span class="va">x_min</span>, xmax <span class="op">=</span> <span class="va">x_max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot units, patterned by rock type</span></span>
<span>  <span class="fu"><a href="https://trevorldavis.com/R/ggpattern/reference/geom-docs.html" class="external-link">geom_rect_pattern</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>pattern_type <span class="op">=</span> <span class="va">pattern</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"geo"</span>,</span>
<span>                    pattern_scale <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://trevorldavis.com/R/ggpattern/reference/scale_pattern_identity.html" class="external-link">scale_pattern_type_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add text labels</span></span>
<span>  <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_max</span>, y <span class="op">=</span> <span class="va">m_age</span>, label <span class="op">=</span> <span class="va">unit_name</span><span class="op">)</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">3.5</span>, hjust <span class="op">=</span> <span class="fl">0</span>, force <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  min.segment.length <span class="op">=</span> <span class="fl">0</span>, direction <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                  nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep_len</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">17</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reverse direction of y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">66</span><span class="op">)</span>, n.breaks <span class="op">=</span> <span class="fl">10</span>, name <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theming</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add geological time scale</span></span>
<span>  <span class="fu"><a href="../reference/coord_geo.html">coord_geo</a></span><span class="op">(</span>pos <span class="op">=</span> <span class="st">"left"</span>, dat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"stages"</span><span class="op">)</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
<p><img src="geo_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Oh no! This is a good example of how the defaults change between the
two methods. We can easily fix this by specifying our own defaults:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_juan_units</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">b_age</span>, ymax <span class="op">=</span> <span class="va">t_age</span>,</span>
<span>                           xmin <span class="op">=</span> <span class="va">x_min</span>, xmax <span class="op">=</span> <span class="va">x_max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot units, patterned by rock type</span></span>
<span>  <span class="fu"><a href="https://trevorldavis.com/R/ggpattern/reference/geom-docs.html" class="external-link">geom_rect_pattern</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>pattern_type <span class="op">=</span> <span class="va">pattern</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"geo"</span>,</span>
<span>                    pattern_color <span class="op">=</span> <span class="st">"black"</span>, pattern_fill <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>                    fill <span class="op">=</span> <span class="st">"white"</span>, pattern_scale <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://trevorldavis.com/R/ggpattern/reference/scale_pattern_identity.html" class="external-link">scale_pattern_type_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add text labels</span></span>
<span>  <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_max</span>, y <span class="op">=</span> <span class="va">m_age</span>, label <span class="op">=</span> <span class="va">unit_name</span><span class="op">)</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">3.5</span>, hjust <span class="op">=</span> <span class="fl">0</span>, force <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  min.segment.length <span class="op">=</span> <span class="fl">0</span>, direction <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                  nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep_len</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">17</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reverse direction of y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">66</span><span class="op">)</span>, n.breaks <span class="op">=</span> <span class="fl">10</span>, name <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theming</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add geological time scale</span></span>
<span>  <span class="fu"><a href="../reference/coord_geo.html">coord_geo</a></span><span class="op">(</span>pos <span class="op">=</span> <span class="st">"left"</span>, dat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"stages"</span><span class="op">)</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
<p><img src="geo_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>There we go, now the patterns are more zoomed in! Hmm…now it looks a
little boring. Let’s go ahead and bring back those colors from before.
We’ll make both the background color (<code>fill</code>) and the pattern
fill color (<code>pattern_fill</code>) based on the “color” column:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">san_juan_units</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">b_age</span>, ymax <span class="op">=</span> <span class="va">t_age</span>,</span>
<span>                           xmin <span class="op">=</span> <span class="va">x_min</span>, xmax <span class="op">=</span> <span class="va">x_max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot units, patterned by rock type</span></span>
<span>  <span class="fu"><a href="https://trevorldavis.com/R/ggpattern/reference/geom-docs.html" class="external-link">geom_rect_pattern</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>pattern_type <span class="op">=</span> <span class="va">pattern</span>, fill <span class="op">=</span> <span class="va">color</span>,</span>
<span>                        pattern_fill <span class="op">=</span> <span class="va">color</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"geo"</span>,</span>
<span>                    pattern_color <span class="op">=</span> <span class="st">"black"</span>, pattern_scale <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://trevorldavis.com/R/ggpattern/reference/scale_pattern_identity.html" class="external-link">scale_pattern_type_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Use the raw color values</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_fill_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://trevorldavis.com/R/ggpattern/reference/scale_pattern_identity.html" class="external-link">scale_pattern_fill_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add text labels</span></span>
<span>  <span class="fu"><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_text_repel</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_max</span>, y <span class="op">=</span> <span class="va">m_age</span>, label <span class="op">=</span> <span class="va">unit_name</span><span class="op">)</span>,</span>
<span>                  size <span class="op">=</span> <span class="fl">3.5</span>, hjust <span class="op">=</span> <span class="fl">0</span>, force <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  min.segment.length <span class="op">=</span> <span class="fl">0</span>, direction <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                  nudge_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep_len</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">17</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reverse direction of y-axis</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">145</span>, <span class="fl">66</span><span class="op">)</span>, n.breaks <span class="op">=</span> <span class="fl">10</span>, name <span class="op">=</span> <span class="st">"Time (Ma)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Theming</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>        axis.line.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.ticks.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add geological time scale</span></span>
<span>  <span class="fu"><a href="../reference/coord_geo.html">coord_geo</a></span><span class="op">(</span>pos <span class="op">=</span> <span class="st">"left"</span>, dat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"stages"</span><span class="op">)</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
<p><img src="geo_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Well isn’t that a nice looking visualization of the stratigraphic
column!</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://williamgearty.com" class="external-link">William Gearty</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
